{"version":3,"file":"index.js","sourceRoot":"","sources":["../../../../src/oracle/index.ts"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA2BA;IACE,gBAAqB,MAAyB,EAAW,OAAe;QAAnD,WAAM,GAAN,MAAM,CAAmB;QAAW,YAAO,GAAP,OAAO,CAAQ;IAAG,CAAC;IAE5E;;OAEG;IACiB,aAAM,GAA1B,UACE,MAAyB,EACzB,MAAc,EACd,OAAyB;;;;;4BAEM,qBAAM,MAAM,CAAC,UAAU,CAAC,OAAO,CAAC,EAAA;;wBAAvD,kBAAkB,GAAK,CAAA,SAAgC,CAAA,mBAArC;wBAE1B,IAAI,OAAO,CAAC,UAAU,IAAI,CAAC,OAAO,CAAC,aAAa,EAAE,CAAC;4BACjD,MAAM,IAAI,KAAK,CAAC,gDAAgD,CAAC,CAAC;wBACpE,CAAC;6BAAM,IAAI,CAAC,OAAO,CAAC,UAAU,IAAI,CAAC,OAAO,CAAC,WAAW,EAAE,CAAC;4BACvD,MAAM,IAAI,KAAK,CAAC,qCAAqC,CAAC,CAAC;wBACzD,CAAC;wBAED,sBAAO,MAAM,CAAC,KAAK,CAAC,WAAW,CAAC,KAAK,CAAC,MAAM,CAAC;gCAC3C,MAAM,QAAA;gCACN,IAAI,EAAE;oCACJ,QAAQ,EAAE,UAAG,kBAAkB,8BAA2B;oCAC1D,iBAAiB,EAAE;wCACjB,OAAO,CAAC,UAAU,CAAC,CAAC,CAAC,OAAO,CAAC,aAAa,CAAC,CAAC,CAAC,OAAO,CAAC,WAAW;wCAChE,KAAK,CAAC,IAAI,CAAC,MAAM,CAAC,IAAI,CAAC,OAAO,CAAC,SAAS,EAAE,KAAK,CAAC,CAAC;qCAClD;iCACF;6BACF,CAAC,EAAC;;;;KACJ;IAKH,aAAC;AAAD,CAAC,AAlCD,IAkCC;AAlCY,wBAAM","sourcesContent":["import {\n  SwitchboardClient,\n  CommonOptions,\n} from \"../index.js\";\nimport { SimpleTransaction } from \"@aptos-labs/ts-sdk\";\n\nexport interface OracleInitParams extends CommonOptions {\n  oracleKey: string;\n  isGuardian?: boolean;\n}\n\nexport interface OracleAttestParams extends CommonOptions {\n  minAttestations: number;\n  isGuardian?: boolean;\n  solanaRPCUrl?: string;\n}\nexport interface OracleData {\n  expirationTime: number;\n  address: string;\n  mrEnclave: string;\n  oracleKey: string;\n  queue: string;\n  queueKey: string;\n  secp256k1Key: string;\n  validAttestations: any[];\n}\n\nexport class Oracle {\n  constructor(readonly client: SwitchboardClient, readonly address: string) {}\n\n  /**\n   * Create a new Oracle\n   */\n  public static async initTx(\n    client: SwitchboardClient,\n    sender: string,\n    options: OracleInitParams\n  ): Promise<SimpleTransaction> {\n    const { switchboardAddress } = await client.fetchState(options);\n\n    if (options.isGuardian && !options.guardianQueue) {\n      throw new Error(\"Guardian queue is required for guardian oracle\");\n    } else if (!options.isGuardian && !options.oracleQueue) {\n      throw new Error(\"Oracle queue is required for oracle\");\n    }\n\n    return client.aptos.transaction.build.simple({\n      sender,\n      data: {\n        function: `${switchboardAddress}::oracle_init_action::run`,\n        functionArguments: [\n          options.isGuardian ? options.guardianQueue : options.oracleQueue,\n          Array.from(Buffer.from(options.oracleKey, \"hex\")),\n        ],\n      },\n    });\n  }\n\n  /**\n   * TODO: Oracle attest TX [switchboard internal]\n   */\n}\n"]}